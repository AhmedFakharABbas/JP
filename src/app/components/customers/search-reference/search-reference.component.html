<section>
  <div class="container">
    <div class="card" style="background-color: #ee3724">
      <div class="card-body" style="padding: 5px">
        <h3 style="text-align: center; color: #fff; margin-bottom: 0px">
          Search Reference
        </h3>
      </div>
    </div>
  </div>
</section>
<section class="mb-3">
  <div class="container">
    <div class="card">
      <div class="card-body">
        <!-- (ngSubmit)="referenceForm.valid ? onFilterReference() :0" #referenceForm="ngForm" -->
        <form>
          <div class="row">
            <div class="col">
              <button
                type="button"
                class="btn btn-primary color d-block ml-auto"
                (click)="onNavigateCreateCustomer()"
              >
                <i class="fas fa-user-plus mr-2"></i>Customer
              </button>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-12 col-md-12 col-lg-6">
              <mat-form-field>
                <input
                  type="text"
                  matInput
                  placeholder="First Name"
                  name="first_name"
                  [(ngModel)]="searchCustomerReferenceObj.first_name"
                />
              </mat-form-field>
            </div>
            <div class="col-sm-12 col-md-12 col-lg-6">
              <mat-form-field>
                <input
                  type="text"
                  matInput
                  placeholder="Last Name"
                  name="last_name"
                  [(ngModel)]="searchCustomerReferenceObj.last_name"
                />
              </mat-form-field>
            </div>
          </div>
          <div id="collapseReference" class="collapse">
            <div class="row">
              <div class="col-sm-12 col-md-12 col-lg-4">
                <mat-form-field>
                  <input
                    type="text"
                    matInput
                    placeholder="Address Line 1"
                    name="address_1"
                    [(ngModel)]="searchCustomerReferenceObj.address_1"
                  />
                </mat-form-field>
              </div>
              <div class="col-sm-12 col-md-12 col-lg-4">
                <mat-form-field>
                  <input
                    type="text"
                    matInput
                    placeholder="Address Line 2"
                    name="address_2"
                    [(ngModel)]="searchCustomerReferenceObj.address_2"
                  />
                </mat-form-field>
              </div>
              <div class="col-sm-12 col-md-12 col-lg-4">
                <mat-form-field>
                  <input
                    type="text"
                    matInput
                    placeholder="Subdivision Name"
                    name="sub_division_name"
                    [(ngModel)]="searchCustomerReferenceObj.sub_division_name"
                  />
                </mat-form-field>
              </div>
            </div>
            <div class="row">
              <div class="col-sm-12 col-md-12 col-lg-4">
                <mat-form-field>
                  <mat-select
                    id="cities"
                    name="cities"
                    placeholder="City"
                    #city_id="ngModel"
                    [(ngModel)]="searchCustomerReferenceObj.city_id"
                    required
                  >
                    <mat-option *ngFor="let city of cities" [value]="city.id">{{
                      city.name
                    }}</mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
              <div class="col-sm-12 col-md-12 col-lg-4">
                <mat-form-field>
                  <mat-select
                    id="state_ID"
                    placeholder="State"
                    name="state_id"
                    #state_id="ngModel"
                    [(ngModel)]="searchCustomerReferenceObj.state_id"
                    required
                  >
                    <mat-option
                      *ngFor="let state of states"
                      [value]="state.id"
                      >{{ state.name }}</mat-option
                    >
                  </mat-select>
                </mat-form-field>
              </div>
              <div class="col-sm-12 col-md-12 col-lg-4">
                <mat-form-field>
                  <input
                    type="text"
                    matInput
                    placeholder="Zip"
                    name="zip_code"
                    [(ngModel)]="searchCustomerReferenceObj.zip_code"
                  />
                </mat-form-field>
              </div>
            </div>
            <div class="row">
              <div class="col-sm-12 col-md-12 col-lg-4">
                <mat-form-field>
                  <input
                    type="text"
                    matInput
                    placeholder="Major Intersection"
                    name="major_intersection"
                    [(ngModel)]="searchCustomerReferenceObj.major_intersection"
                  />
                </mat-form-field>
              </div>

              <div class="col-sm-12 col-md-12 col-lg-4">
                <mat-form-field>
                  <mat-select
                    id="referenceStatus"
                    placeholder="Reference Status"
                    name="referenceStatus"
                    #referenceStatus="ngModel"
                    [(ngModel)]="
                      searchCustomerReferenceObj.reference_status_type_id
                    "
                    required
                  >
                    <mat-option
                      *ngFor="let status of statuses"
                      [value]="status.status_id"
                      >{{ status.status_name }}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>

              <div class="col-sm-12 col-md-12 col-lg-4">
                <mat-form-field>
                  <mat-select
                    name="project_type_id"
                    id="project_type_id"
                    [(ngModel)]="searchCustomerReferenceObj.project_type_id"
                    placeholder="Project type"
                    #project_type_id="ngModel"
                    required
                  >
                    <mat-option
                      *ngFor="let project of project_types"
                      [value]="project.id"
                      >{{ project.name }}</mat-option
                    >
                  </mat-select>
                </mat-form-field>
              </div>
            </div>
          </div>
          <div class="row justify-content-between">
            <div class="col-sm-6 col-md-6 float-left">
              <button
                data-toggle="collapse"
                class="btn btn-primary color mt-4"
                href="#collapseReference"
                aria-expanded="false"
                aria-controls="collapseReference"
              ></button>
            </div>
            <div class="col-sm-6 col-md-6 float-left">
              <button
                type="submit"
                class="btn btn-primary color mt-4 float-right"
                id="search_button"
                (click)="onGetCustomerReferenceSearchFilterMeta()"
              >
                <i class="fas fa-search"></i> Search
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</section>

<section class="mb-3">
  <div class="container" style="margin-top: 3%">
    <div class="card">
      <div class="card-body">
        <div class="row justify-content-end pb-3">
          <!-- <div class="col-md-6 float-left">
            <button type="button" class="btn btn-primary color float-right" id="add_project" placement="top"
              ngbTooltip="Add Project" routerLink="/create-customer">
              <i class="fas fa-task"></i>Add Project
            </button>
          </div> -->
        </div>
        <div class="table-responsive table-striped">
          <table class="table mb-5">
            <thead>
              <tr>
                <th scope="col">First Name</th>
                <th scope="col">Last Name</th>
                <th scope="col">Company</th>
                <th scope="col">Create Date</th>
                <th scope="col">Date Modified</th>
                <th scope="col">Actions</th>
                <!-- <th scope="col">Export As</th> -->
              </tr>
            </thead>
            <tbody>
              <tr
                *ngFor="
                  let customerdetail of customerDetails
                    | paginate: { itemsPerPage: 5, currentPage: p }
                "
              >
                <td>{{ customerdetail.first_name }}</td>
                <td>{{ customerdetail.last_name }}</td>
                <td>{{ customerdetail.company }}</td>
                <td>{{ customerdetail.created_on | date: "MM/dd/yyyy" }}</td>
                <td>{{ customerdetail.updated_at | date: "MM/dd/yyyy" }}</td>
                <td>
                  <a
                    style="color: #212529; margin-right: 7px"
                    [routerLink]="['/customer/view', customerdetail.id]"
                    ><i class="fas fa-eye" placement="top" ngbTooltip="View"></i
                  ></a>
                  <a
                    [routerLink]="['/customer/edit', customerdetail.id]"
                    placement="top"
                    ngbTooltip="Edit"
                  >
                    <!-- <i class="ml-3 fas fa-edit" placement="top" ngbTooltip="Edit"></i> -->
                    <svg
                      aria-hidden="true"
                      style="width: 12px; margin-left: 7px"
                      focusable="false"
                      data-prefix="fas"
                      data-icon="edit"
                      role="img"
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 576 512"
                      class="svg-inline--fa fa-edit fa-w-18 fa-spin fa-lg"
                    >
                      <path
                        fill="currentColor"
                        d="M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"
                        class=""
                      ></path>
                    </svg>
                  </a>
                  <a
                    (click)="
                      openCustomerReferenceModel(
                        customerReferenceModel,
                        customerdetail.id
                      )
                    "
                    ><i
                      class="ml-3 fas fa-trash"
                      placement="top"
                      ngbTooltip="Delete"
                    ></i
                  ></a>
                </td>
                <!-- <td>
                  <i class="fas fa-download" style="cursor: pointer" ngbTooltip="Download CSV File" placement="top"></i>
                  <i class="fas ml-3 fa-file-excel" style="cursor: pointer" ngbTooltip="Download Excel File"
                    placement="top"></i>
                </td> -->
              </tr>
              <tr *ngIf="customerDetails?.length == 0">
                <td colspan="7">
                  <p class="text-center">
                    Your search returned no results, please try again.
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="row justify-content-end">
          <div class="col">
            <pagination-controls
              (pageChange)="p = $event"
              class="text-right"
            ></pagination-controls>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<ng-template #customerReferenceModel let-c="close" let-d="dismiss">
  <div class="modal-header">
    <h6 class="modal-title">Delete Customer</h6>
    <button type="button" class="close" (click)="c('Close click')">
      &times;
    </button>
  </div>
  <div class="modal-body">
    <h6 style="color: red">Are you sure to delete this customer?</h6>
    <div class="modal-footer">
      <button
        type="button"
        class="btn btn-primary-outline color"
        (click)="c('Close click')"
      >
        Close
      </button>
      <button
        type="submit"
        class="btn btn-primary color"
        (click)="ondeleteCustomers(customerId)"
      >
        Delete
      </button>
    </div>
  </div>
</ng-template>
